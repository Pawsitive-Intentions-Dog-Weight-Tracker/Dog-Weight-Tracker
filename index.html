<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dog Weight Tracker</title>
  <meta name="theme-color" content="#0f766e" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%230f766e'/%3E%3Ctext x='50%25' y='54%25' dominant-baseline='middle' text-anchor='middle' font-size='40'%3E%F0%9F%90%B6%3C/text%3E%3C/svg%3E">
</head>
<body>
  <header>
    <h1>üêæ Dog Weight Tracker</h1>
    <p class="subtitle">Works offline ‚Ä¢ Exports CSV ‚Ä¢ No login required</p>
  </header>

  <main>
    <!-- Dog management -->
    <section class="card">
      <h2>Dogs</h2>

      <div class="row">
        <label for="dogSelect">Select dog</label>
        <select id="dogSelect"></select>
        <button id="deleteDogBtn" class="danger" title="Remove dog and all its entries">Delete Dog</button>
      </div>

      <div class="grid2">
        <div class="row">
          <label for="newDogName">Dog name</label>
          <input id="newDogName" type="text" placeholder="e.g. Raq" />
        </div>
        <div class="row">
          <label for="newOwner">Owner surname</label>
          <input id="newOwner" type="text" placeholder="e.g. Yoxall" />
        </div>
      </div>
      <div class="row">
        <label for="newBreed">Breed</label>
        <input id="newBreed" type="text" placeholder="e.g. Border Collie" />
        <button id="addDogBtn">Add Dog</button>
      </div>
      <p class="hint">Tip: The selector will show ‚ÄúDog Name ‚Äî Owner (Breed)‚Äù.</p>
    </section>

    <!-- Add a measurement -->
    <section class="card">
      <h2>Add Weight</h2>
      <div class="grid2">
        <div class="row">
          <label for="dtInput">Date &amp; time</label>
          <input id="dtInput" type="datetime-local" />
        </div>
        <div class="row">
          <label for="weightInput">Weight (kg)</label>
          <input id="weightInput" type="number" inputmode="decimal" step="0.01" placeholder="e.g. 21.30" />
        </div>
      </div>
      <div class="row">
        <label for="notesInput">Notes (optional)</label>
        <input id="notesInput" type="text" placeholder="e.g. after dinner / vet scale" />
      </div>
      <button id="addEntryBtn">Add Entry</button>
      <button id="dupLastBtn" title="Duplicate last entry for the selected dog, with current date/time">Duplicate Last Entry</button>
    </section>

    <!-- Actions -->
    <section class="card">
      <h2>Data & Export</h2>
      <div class="wrap">
        <button id="exportCsvBtn">Export CSV (selected dog)</button>
        <button id="exportAllCsvBtn">Export CSV (all dogs)</button>
        <button id="backupJsonBtn">Backup (JSON)</button>
        <label class="fileLabel">
          Restore (JSON)
          <input id="restoreJsonInput" type="file" accept="application/json" />
        </label>
        <button id="clearAllBtn" class="danger" title="Remove ALL data from this device">Clear ALL Data</button>
        <button id="installBtn" style="margin-left:auto">Install App</button>
      </div>
      <p class="hint">Data is stored on this device only. Use Backup/Restore to move between devices.</p>
    </section>

    <!-- Trend chart -->
    <section class="card">
      <h2>Trend</h2>
      <div class="tableWrap">
        <canvas id="chart" style="width:100%;height:260px;"></canvas>
      </div>
      <p class="hint">Shows the selected dog‚Äôs weights over time.</p>
    </section>

    <!-- Entries table -->
    <section class="card">
      <h2 id="entriesTitle">Entries</h2>
      <div class="tableWrap">
        <table id="entriesTable">
          <thead>
            <tr>
              <th>Date &amp; time</th>
              <th>Dog</th>
              <th>Owner</th>
              <th>Breed</th>
              <th>Weight (kg)</th>
              <th>Notes</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="entriesBody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer>
    <p>Offline-capable PWA. Made by you ‚ú®</p>
  </footer>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(console.error);
      });
    }
  </script>
  <script src="script.js"></script>
</body>
</html>
